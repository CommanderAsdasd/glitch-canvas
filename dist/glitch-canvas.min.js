//! glitch-canvas by snorpey, MIT License
!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.glitch=b()}(this,function(){function a(a,t,u){if(a&&t&&u){for(i=h(t),b(q,a),b(r,a),j=d(a,i.quality),k=f(j),l=e(k),o=0,p=i.iterations;p>o;o++)c(k,l,i.seed,i.amount,o,i.iterations);m=new Image,m.onload=function(){s.drawImage(m,0,0),n=s.getImageData(0,0,a.width,a.height),u(n)},m.src=g(k)}}function b(a,b){a.width!==b.width&&(a.width=b.width),a.height!==b.height&&(a.height=b.height)}function c(a,b,c,d,e,f){var g=a.length-b-4,h=parseInt(g/f*e,10),i=parseInt(g/f*(e+1),10),j=i-h,k=parseInt(h+j*c,10);k>g&&(k=g);var l=Math.floor(b+k);a[l]=Math.floor(256*d)}function d(a,b){var c="number"==typeof b&&1>b&&b>0?b:.1;return t.putImageData(a,0,0),r.toDataURL("image/jpeg",c)}function e(a){var b=417;for(o=0,p=a.length;p>o;o++)if(255===a[o]&&218===a[o+1]){b=o+2;break}return b}function f(a){var b,c,d,e=[];for(o=23,p=a.length;p>o;o++){switch(c=w[a.charAt(o)],b=(o-23)%4){case 1:e.push(d<<2|c>>4);break;case 2:e.push((15&d)<<4|c>>2);break;case 3:e.push((3&d)<<6|c)}d=c}return e}function g(a){var b,c,d,e=["data:image/jpeg;base64,"];for(o=0,p=a.length;p>o;o++){switch(c=a[o],b=o%3){case 0:e.push(v[c>>2]);break;case 1:e.push(v[(3&d)<<4|c>>4]);break;case 2:e.push(v[(15&d)<<2|c>>6]),e.push(v[63&c])}d=c}return 0===b?(e.push(v[(3&d)<<4]),e.push("==")):1===b&&(e.push(v[(15&d)<<2]),e.push("=")),e.join("")}function h(a){return{seed:(a.seed||25)/100,quality:(a.quality||30)/100,amount:(a.amount||35)/100,iterations:a.iterations||20}}var i,j,k,l,m,n,o,p,q=document.createElement("canvas"),r=document.createElement("canvas"),s=q.getContext("2d"),t=r.getContext("2d"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v=u.split(""),w={};return v.forEach(function(a,b){w[a]=b}),a});